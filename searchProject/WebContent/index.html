<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>도로명주소 검색</title>
<script src="/searchProject/js/check.js"></script>
<script type="text/javascript">
	function search(){
		var bool=false;
		var xmlHttpReq;
		console.log("xmlHttpReq >>> : "+xmlHttpReq)
		
		var currentPage=document.getElementById("currentPage").value;
	    var countPerPage=document.getElementById("countPerPage").value;
	    var keyword=document.getElementById("keyword").value;
	    var resultType=document.getElementById("resultType").value;
	    var confmKey=document.getElementById("confmKey").value;
	    
	    console.log("현재 페이지 번호 >>> : "+currentPage);
	    console.log("페이지당 출력 개수  >>> : "+countPerPage);
	    console.log("키워드 >>> : "+keyword);
	    console.log("검색 결과 형식 >>> : "+resultType);
	    console.log("api 키 >>> : "+confmKey);
	    
		bool=check(currentPage,countPerPage, keyword);
		alert("검색가능여부 >>> : "+bool);
		
		// HTTP request 만들기
		if(window.XMLHttpRequest){
			xmlHttpReq=new XMLHttpRequest();
			alert("1. HTTP request 만들기 >>> : "+xmlHttpReq);
		}else if(window.ActiveXObject){
			xmlHttpReq=new ActiveXObject("MicrosoftXMLHTTP");
			alert("xmlHttpReq >>> : "+xmlHttpReq);
		}
		
		console.log("xmlHttpReq >>> : "+xmlHttpReq);
		
		// readyState 확인
		/*
		UNSENT : 0
		OPENED : 1
		*/
		console.log("xmlHttpReq.readyState >>> : "+xmlHttpReq.readyState);	
		// 0
		
		xmlHttpReq.open('GET', '/searchProject/RwkCommonController.do?currentPage='+currentPage
						+'&countPerPage='+countPerPage+'&keyword='+keyword
						+'&resultType='+resultType+'&confmKey='+confmKey);
		xmlHttpReq.send();
		
		// readyState 확인
		console.log("xmlHttpReq.readyState >>> : "+xmlHttpReq.readyState);
		// 1
		
		if(xmlHttpReq.readyState==1){
			// 현재 상태 보기
			/*
			UNSENT : 0
			OPENED : 0
			LOADING : 200
			DONE  : 200S
			*/
			var xmlHttpReqStatus=xmlHttpReq.status;
			var staustext=xmlHttpReq.statusText;
			
			console.log("xmlHttpReqStatus >>> : "+xmlHttpReqStatus);
			// 0
			console.log("staustext >>> : "+staustext);
			
			var jsonStr=xmlHttpReq.response;
			console.log("jsonStr >>> : "+jsonStr);
			console.log("typeof(jsonStr) >>> : "+typeof(jsonStr));
			
			var obj=JSON.parse(jsonStr);
			console.log("json 파싱 >>>  : "+obj);
			console.log("typeof(obj) >>> : "+typeof(obj));
		}
		
		
	}
</script>
</head>
<body>
<table>
	<caption><b>도로명 주소 검색</b></caption>
	<tr>
		<td>현재 페이지 번호</td>
		<td><input type="text" id="currentPage" name="currentPage" required></td>
	</tr>
	<tr>
		<td>페이지당 출력 개수</td>
		<td><input type="text" id="countPerPage" name="countPerPage" required></td>
	</tr>
	<tr>
		<td>키워드</td>
		<td><input type="text" id="keyword" name="keyword" required></td>
	</tr>
	<tr>
		<td colspan="2">
			<button id="btn" onClick="search()">검색</button>
		</td>
	</tr>
</table>
<!-- 검색결과 형식  -->
<input type="hidden" id="resultType" name="resultType" value="json">
<!-- api 승인 키 : 사용기간 : 2022-08-18 ~ 2022-08-25 -->
<input type="hidden" id="confmKey" name="confmKey" value="devU01TX0FVVEgyMDIyMDgxODIzMjYwODExMjg5OTY=">
<!-- api key : devU01TX0FVVEgyMDIyMDgxODIzMjYwODExMjg5OTY= -->
</body>
</html>